<html>
	<head>
		<script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
		<script type="text/processing"></script>
		<script type="text/processing" data-processing-target="mycanvas">

		//screen dimensions
		var width = 800;
		var height = 500;
		var dir = "down"; 
		var paused = true;
		Nick nick;
		enemies = new Array();
		var lives = 3;
		//initialized to number of 2's in first level
		var numberOfPoints=197;
		var level = 0;
		
		var pointCounter = 0;
		
		var levels = [//1 = wall, 0 = space 2 = spots 20 rows / columns
			[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,2,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1],
			[1,2,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,2,1,1,2,2,2,1,1,1,1,1,1,2,2,2,1,1,2,1],
			[2,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,2],
			[1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1],
			[1,1,1,1,2,2,1,1,1,1,2,1,1,1,2,2,1,1,1,1],
			[1,1,1,1,2,2,1,2,2,2,2,2,2,1,2,2,1,1,1,1],
			[1,1,1,1,2,2,1,1,1,1,1,1,1,1,2,2,1,1,1,1],
			[1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1],
			[1,1,1,1,2,2,2,2,2,1,1,2,2,2,2,2,1,1,1,1],
			[2,2,2,2,2,2,2,1,1,1,1,1,1,2,2,2,2,2,2,2],
			[1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1],
			[1,2,1,1,2,1,1,1,1,2,2,1,1,1,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,2,2,2,2,2,2,2,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,1,1,1,1,1,1,2,1,2,1,1,2,1],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]], 
			
			[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,2,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1],
			[1,2,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1],
			[1,2,2,2,2,1,2,2,2,2,2,2,2,2,1,2,2,2,2,1],
			[1,2,1,1,2,1,2,1,1,1,1,1,1,2,1,2,1,1,2,1],
			[1,2,2,2,2,2,2,2,2,1,1,2,2,2,2,2,2,2,2,1],
			[1,1,1,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1],
			[1,2,2,2,1,2,1,1,1,1,2,1,1,1,2,1,2,2,2,1],
			[1,2,1,2,1,2,1,2,2,2,2,2,2,1,2,1,2,1,2,1],
			[1,2,1,2,1,2,1,1,1,1,1,1,1,1,2,1,2,1,2,1],
			[1,2,2,2,1,2,2,2,2,2,2,2,2,2,2,1,2,2,2,1],
			[1,1,1,2,1,2,2,2,2,1,1,2,2,2,2,1,2,1,1,1],
			[2,2,2,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,2],
			[1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1],
			[1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,2,2,2,2,2,2,2,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,1,1,1,1,1,1,2,1,2,1,1,2,1],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]], 
			
			[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3],
			[1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1],
			[1,2,1,1,2,1,1,1,2,1,1,2,1,1,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,1,2,1,1,2,1,2,1,2,1,1,2,1],
			[1,2,2,2,2,1,2,2,2,2,2,2,2,2,1,2,2,2,2,1],
			[1,2,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1],
			[2,2,2,2,2,2,2,1,2,1,1,1,1,1,2,2,2,2,2,2],
			[1,1,1,2,1,2,2,2,2,2,2,2,2,2,2,1,2,1,1,1],
			[1,2,2,2,1,2,1,1,1,1,2,1,1,1,2,1,2,2,2,1],
			[1,1,1,2,1,2,1,2,2,2,2,2,2,1,2,1,2,1,1,1],
			[1,2,1,2,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1],
			[1,2,2,2,1,2,2,2,2,1,2,2,2,2,2,1,2,2,2,1],
			[1,1,1,2,1,2,1,2,2,1,2,2,2,2,1,1,2,1,1,1],
			[2,2,2,2,2,2,1,1,1,1,2,1,1,2,2,2,2,2,2,2],
			[1,2,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,1],
			[1,2,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1,2,2,1],
			[1,2,2,2,2,1,2,2,2,2,2,2,2,2,1,2,1,1,2,1],
			[1,2,1,1,2,1,2,1,1,1,1,1,1,1,1,2,2,1,2,1],
			[1,2,2,2,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,1],
			[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]]
			
			];
		
		//current level
		var maze;
		
		//cell width and cell height
		var cellWidth = 20;
		var cellHeight = 20; 

			void setup()
			{
			
			  size(width,height);
			  background(125);
			  fill(255);
			  //noLoop();
			  PFont fontA = loadFont("courier");
			  textFont(fontA, 14); 
			  nick = new Nick(5, 5, 100, 25, 3); 
			  enemies.push(new Enemy(5, 5, 30, 25, 3));
			  enemies.push(new Enemy(5, 5, 30, 125, 3));
			  enemies.push(new Enemy(5, 5, 320, 85, 3));
			  maze = levels[level];

			  
			}

			void draw(){  
				background(125);
			  text("Hello Web!",20,20);
			  println("Hello ErrorLog!");
			 
			  //build the maze
			  for(int i =0; i< maze.length; i++){
			  	for(int j = 0; j<maze[0].length; j++){
					//draw every cell
					var x = cellWidth * j;
					var y = cellHeight *i;
					if(maze[i][j] == 0 || maze[i][j] == 2){
						//is space
						noStroke();
						fill(255, 0,0);
						rect(x, y, cellWidth, cellHeight); 
						if(maze[i][j] == 2){
							fill(255,255,255);
							ellipse(x+10,y+10, 10, 10);
						
						}
						
					}else if(maze[i][j] == 1 || maze[i][j] ==3){
						//is wall
						noStroke();
						fill(0,0,255);
						rect(x, y, cellWidth, cellHeight); 
						if(maze[i][j] == 3){
							fill(255,0,0);
                			ellipse(x+10,y+10, 10, 10);
						}
					}
					
			  		
			  	}
			  }
			  
			  nick.drawNick();
			  for(int i = 0; i<enemies.length; i++){
			  	enemies[i].drawEnemy();
			  	if(!paused)
			  		enemies[i].moveEnemy();
			  		
			  	if(Math.abs((nick.x- enemies[i].x)) < 10 && Math.abs((nick.y - enemies[i].y)) <10){
			  		nick.die();
			  	
			  	}
			  }
			  
			  
			  //detect key,and decide direction
			  if(keyPressed==true){
			  	if(keyCode ==39){
			  		dir = "right";
			  	}else if (keyCode == 37){
			  		dir = "left";
			  	}else if(keyCode == 38){
			  		dir = "up";
			  	}else if(keyCode == 40){
			  		dir = "down";
			  	}
			  	
			  }
			  
			  //only move if not touching wall
			  
			  if(!paused && nick.canMove(dir)){
			  	nick.moveNick(dir);
			  }
			  console.log(pointCounter);
			  
			  //when collected all points, change levels
			  if(pointCounter==numberOfPoints){
			  	if(level+1 < levels.length){
			  		maze = levels[++level];
				  	pointCounter = 0;
				  	if(level ==1){
				  		numberOfPoints = 201;
				  	}else{
			  			//number of points in level 2
				  		numberOfPoints = 197;
			  	
			  	
			  		}
			  	}
			  }
			  
			  
				if(lives == 0){
					lives = 3;
					maze = levels[0];
					maze[0][19] = 3;
					maze[0][18] = 3;
					for(int i = 0; i<maze.length; i++){
						for(int j = 0; j<maze.length; j++){
							if(maze[i][j] ==0){
								maze[i][j]=2;
							}
						}
					}
					
					for(int j =0; j<enemies.length; j++){
						enemies[j].x = enemies[j].startX;
						enemies[j].y = enemies[j].startY;
					}
					paused = true;
				}
				//steven
				var w = 5;
var h = 5;
var x = 100;
var y = 100;


			  

			  

		}
		
		
		class Nick{
			var w;
			var h; 
			var x;
			var y;
			var s;
			
			Nick(nWidth,nHeight,xVal, yVal, speed){
				w=nWidth;
				h=nHeight;
				x = xVal;
				y=yVal;
				s = speed;
			}
			void drawNick(){
				noStroke();
				fill(0,0,0);
				ellipse(x,y-4,1.5*w, h);
				ellipse(x-2,y,1.5*w, h);
				ellipse(x+6.5,y-6,1.5*w, h);
				ellipse(x+12,y-5,1.5*w, h);
				rect(x,y-4,3*w,2*h);
				fill(245, 196, 214);
				rect(x,y,3*w,2*h);
				fill(255, 255, 255);
				rect(x+2,y,w,h-1);
				rect(x+9,y,w,h-1);
				fill(0, 0, 0);
				rect(x+3,y,w/2.5,h/2);
				rect(x+10,y,w/2.5,h/2);
				fill(255, 0, 0);
				noStroke();
				rect(x+5,y+5,w*1.5,h*0.3);
				rect(x+7,y+5,w*0.8,h*0.69);
			}
			//called before moveNick 
			
			boolean canMove(dir){
				var canMove = false;
			
				var col = Math.floor(x / cellWidth); 
			  	var row = Math.floor(y / cellHeight);
			  	if(dir =="down" && row+1 < 20){
			  		if(maze[row+1][col] == 0 || maze[row+1][col] == 2){
			  			canMove = true;
			  			if(maze[row+1][col] == 2){
			  				pointCounter++;
			  				maze[row+1][col] = 0;
			  			}
			  		}
			  			
			  	}
			  	if(dir == "up" && row-1 >=0){

			  		if(maze[row-1][col] == 0 || maze[row-1][col] == 2){
			  			canMove = true;
			  			if(maze[row-1][col] == 2){
			  				pointCounter++;
			  				maze[row-1][col] =0;
			  			}
			  		}
			  	}
			  	if(dir == "left" && col -1 >=0 ){
			  		if(maze[row][col-1] == 0 || maze[row][col-1] == 2){
			  			canMove = true;
			  			if(maze[row][col-1] == 2){
			  				pointCounter++;
			  				maze[row][col-1] =0;
			  			}
			  		}
			  	}
			  	if(dir == "right" && col+1 <20){
			  		if(maze[row][col+1] == 0 || maze[row][col+1] == 2){
			  			canMove = true;
			  			if(maze[row][col+1] == 2){
			  				pointCounter++;
			  				maze[row][col+1] = 0;
			  			}
			  		}
			  	}
			  	
				return canMove;
		
				
			}
			
			void moveNick(dir){
			
				
				
				//portals
				if(x > maze[0].length * (cellWidth-1)-5 ){
					x=30;//-= (maze[0].length * (cellWidth-1)-5);
				}else if(x < 30){
					x=maze[0].length * (cellWidth-1)-5;
				}else if(y > maze.length * cellHeight){
					y -= maze.length *cellHeight;
				}else if(y<0){
					y += maze.length* cellHeight;
				}
				
				//don't move until you know the next space is empty
				if (dir == "up"){
					y = y-s;
				}else if (dir == "down"){
					y = y +s;
				}else if (dir == "left"){
					x = x -s; 
				}else if(dir == "right"){
					x = x+s;
				}
			}
			void die(){
				lives--;
				x=60;
				y = 30;
				dir="right";
				if (lives == 2){
					maze[0][19]=1;
				}else{
					maze[0][18]=1;
				
				}
			}
		
		
		}
		class Enemy{
		
			var w;
			var h;
			var startX;
			var startY;
			var x;
			var y;
			var s;
			var dir;
			
			Enemy(width,height,xVal, yVal, speed){
				w=width;
				h = height;
				x = xVal;
				startX = xVal;
				y=yVal;
				startY=yVal;
				s = speed;
				dir = "down";
			}
			void drawEnemy(){
			
				fill(0,0,0);
				rect(x-3,y-3,4*w,2.5*h);
				fill(255, 5, 188);
				rect(x,y,3*w,2*h);
				fill(250, 215, 250);
				rect(x+3,y,w*2.3,h-2);
				line(x+15, y+15, x+15+w*0.8, y+15);
				fill(255, 0, 0);
			/*
				noStroke();
				fill(0,0,255);
			  	rect(x,y,nWidth,nHeight);*/
			}
			void moveEnemy(){
				
				//portals
				if(x > maze[0].length * (cellWidth-1)-5 ){
					x=30;//-= (maze[0].length * (cellWidth-1)-5);
				}else if(x < 30){
					x=maze[0].length * (cellWidth-1)-5;
				}else if(y > maze.length * cellHeight){
					y -= maze.length *cellHeight;
				}else if(y<0){
					y += maze.length* cellHeight;
				}
				if(canMove()){
				//don't move until you know the next space is empty
				if (dir == "up"){
					y = y-s;
				}else if (dir == "down"){
					y = y +s;
				}else if (dir == "left"){
					x = x -s; 
				}else if(dir == "right"){
					x = x+s;
				}
				}else{
					var rand = Math.floor(Math.random() * 4) + 1;
					if (rand == 1){
						dir = "right";
					}else if (rand == 2){
						dir = "left";
					}else if (rand == 3){
						dir = "up";
					}else{
						dir = "down";
					}
				}
			}
			
			boolean canMove(){
			
				var canMove = false;
			
				var col = Math.floor(x / 20); //cellWidth;
			  	var row = Math.floor(y / 20); //cellHeight; 
			  	if(dir =="down" && row+1 < 20){
			  		if(maze[row+1][col] == 0 || maze[row+1][col] == 2){
			  			canMove = true;
			  		}
			  			
			  	}
			  	if(dir == "up" && row-1 >=0){
			  		if(maze[row-1][col] == 0 || maze[row-1][col] == 2){
			  			canMove = true;
			  			
			  		}
			  	}
			  	if(dir == "left" && col -1 >=0 ){
			  		if(maze[row][col-1] == 0 || maze[row][col-1] == 2){
			  			canMove = true;
			  			
			  		}
			  	}
			  	if(dir == "right" && col+1 <20){
			  		if(maze[row][col+1] == 0 || maze[row][col+1] == 2){
			  			canMove = true;
			  			
			  		}
			  	}
			  	
				return canMove;
			}
			
		
		
		}
		mouseClicked = function(){
			paused = !paused; 
		}
		
		/*garnet 
		
		var w = 10;
var h = 10;
var x = 100;
var y = 100;
fill(0,0,0);
rect(x-5,y-5,4*w,2.5*h);
fill(255, 5, 188);
rect(x,y,3*w,2*h);
fill(250, 215, 250);
rect(x+3,y,w*2.7,h-2);
line(x+15, y+15, x+15+w*0.8, y+15);
fill(255, 0, 0);

steven 

var w = 10;
var h = 10;
var x = 100;
var y = 100;
fill(0,0,0);
ellipse(x,y-5,1.5*w, h);
ellipse(x+10,y-10,1.5*w, h);
ellipse(x+20,y-10,1.5*w, h);
ellipse(x+30,y-8,1.5*w, h);
rect(x,y-8,3*w,2*h);
fill(245, 196, 214);
rect(x,y,3*w,2*h);
fill(255, 255, 255);
rect(x+3,y,w,h-2);
rect(x+17,y,w,h-2);
fill(0, 0, 0);
rect(x+3,y,w/2,h/2);
rect(x+17,y,w/2,h/2);
fill(255, 0, 0);
noStroke();
rect(x+11,y+11,w*1.5,h*0.35);
rect(x+15,y+11,w*0.8,h*0.7);

amythest
var w = 10;
var h = 10;
var x = 100;
var y = 100;
fill(250, 230, 250);
ellipse(x+12, y+5, w*5,h*4);
fill(224, 171, 237);
ellipse(x+15,y+10,4*w,3*h);
fill(255, 255, 255);
ellipse(x+6,y+5,w,h-2);
fill(255, 255, 255);
ellipse(x+26,y+5,w,h-2);
fill(0, 0, 0);
rect(x+5,y+2,w/3,h/3);
rect(x+25,y+2,w/3,h/3);
fill(250, 230, 250);
fill(255, 255, 255);
ellipse(x+20,y+15,w*0.8,h*0.7);

pearl
var w = 10;
var h = 10;
var x = 100;
var y = 100;
fill(250, 175, 245);
triangle(x-14, y-8, x+20,y-4,x,y+20);
fill(240, 242, 186);
ellipse(x+15,y+12,3.5*w,3.2*h);
fill(255, 255, 255);
ellipse(x+16,y+1,w*0.8,h*0.7);
ellipse(x+8,y+10,w*0.8,h);
ellipse(x+24,y+10,w*0.8,h);
fill(0, 0, 0);
rect(x+8,y+8,w/3,h/3);
rect(x+24,y+8,w/3,h/3);
fill(255, 255, 255);
ellipse(x+18,y+19,w*0.8,h*0.7);
*/
		

		
		</script>
	</head>
	<body>
		<canvas id="mycanvas"></canvas>
	</body>
</html>